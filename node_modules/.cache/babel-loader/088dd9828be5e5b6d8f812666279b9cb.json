{"ast":null,"code":"import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet';\nimport { postNoProxyConfirmedToTrackingSheet } from './postNoProxyConfirmedOnSheet';\nexport const findMissingFiles = missingFile => {\n  // debugger\n  // const GSHEETS_SHEET_ID = process.env.REACT_APP_QA_SS_PHASEII_SHEET_ID\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `/*/_${missingFile.video.mcVodId}_HD.wmv`;\n  debugger;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    debugger;\n\n    if (rxData.error) {\n      alert(rxData.error.message);\n    } else {\n      let file = rxData.files.find(file => file.name === fileName);\n      debugger;\n      !!file ? postNoProxyToTrackingSheet(missingFile) : searchNextPageForMissingFile(missingFile, rxData.nextPageToken);\n    }\n  });\n};\n\nconst searchNextPageForMissingFile = (missingFile, nextPageToken) => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `/*/_${missingFile.video.mcVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(reponse => reponse.json()).then(rxData => {\n    debugger;\n\n    if (rxData.error) {\n      // TO DO: CHANGE THIS TO MARK THE TRACKING SHEET REVIEWER CELL AS RED\n      debugger;\n      postNoProxyConfirmedToTrackingSheet(missingFile); // alert(`Still Can Not Find ${fileName}`)\n    } else {\n      debugger;\n      let file = rxData.files.find(file => file.name === fileName); // debugger\n\n      !!file ? postNoProxyToTrackingSheet(missingFile) : searchNextPageForMissingFile(missingFile, rxData.nextPageToken);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/findMissingFiles.js"],"names":["postNoProxyToTrackingSheet","postNoProxyConfirmedToTrackingSheet","findMissingFiles","missingFile","ACCESS_TOKEN","process","env","REACT_APP_ACCESS_TOKEN","fileName","video","mcVodId","fetch","headers","authorization","then","response","json","rxData","error","alert","message","file","files","find","name","searchNextPageForMissingFile","nextPageToken","reponse"],"mappings":"AAAA,SAASA,0BAAT,QAA2C,2BAA3C;AACA,SAASC,mCAAT,QAAoD,+BAApD;AAEA,OAAO,MAAMC,gBAAgB,GAAIC,WAAD,IAAiB;AAC7C;AACA;AACA,QAAMC,YAAY,GAAGC,OAAO,CAACC,GAAR,CAAYC,sBAAjC;AACA,MAAIC,QAAQ,GAAK,OAAML,WAAW,CAACM,KAAZ,CAAkBC,OAAQ,SAAjD;AACA;AACAC,EAAAA,KAAK,CAAE,6HAAF,EACD;AACIC,IAAAA,OAAO,EAAE;AACLC,MAAAA,aAAa,EAAG,UAAST,YAAa;AADjC;AADb,GADC,CAAL,CAKOU,IALP,CAKYC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EALxB,EAMKF,IANL,CAMUG,MAAM,IAAI;AACZ;;AACA,QAAGA,MAAM,CAACC,KAAV,EAAgB;AACZC,MAAAA,KAAK,CAACF,MAAM,CAACC,KAAP,CAAaE,OAAd,CAAL;AACH,KAFD,MAEK;AACD,UAAIC,IAAI,GAAGJ,MAAM,CAACK,KAAP,CAAaC,IAAb,CAAkBF,IAAI,IAAIA,IAAI,CAACG,IAAL,KAAchB,QAAxC,CAAX;AACA;AACA,OAAC,CAACa,IAAF,GAASrB,0BAA0B,CAACG,WAAD,CAAnC,GAAmDsB,4BAA4B,CAACtB,WAAD,EAAcc,MAAM,CAACS,aAArB,CAA/E;AACH;AACJ,GAfL;AAgBH,CAtBM;;AAwBP,MAAMD,4BAA4B,GAAG,CAACtB,WAAD,EAAcuB,aAAd,KAAgC;AACjE,QAAMtB,YAAY,GAAGC,OAAO,CAACC,GAAR,CAAYC,sBAAjC;AACA,MAAIC,QAAQ,GAAK,OAAML,WAAW,CAACM,KAAZ,CAAkBC,OAAQ,SAAjD;AAECC,EAAAA,KAAK,CAAE,kHAAiHe,aAAc,yBAAjI,EAA2J;AAC7Jd,IAAAA,OAAO,EAAC;AACJC,MAAAA,aAAa,EAAG,UAAST,YAAa;AADlC;AADqJ,GAA3J,CAAL,CAIEU,IAJF,CAIOa,OAAO,IAAIA,OAAO,CAACX,IAAR,EAJlB,EAKAF,IALA,CAKKG,MAAM,IAAI;AACZ;;AACA,QAAGA,MAAM,CAACC,KAAV,EAAgB;AACZ;AACA;AACAjB,MAAAA,mCAAmC,CAACE,WAAD,CAAnC,CAHY,CAIZ;AACH,KALD,MAKK;AACD;AACA,UAAIkB,IAAI,GAAGJ,MAAM,CAACK,KAAP,CAAaC,IAAb,CAAkBF,IAAI,IAAIA,IAAI,CAACG,IAAL,KAAchB,QAAxC,CAAX,CAFC,CAGD;;AACA,OAAC,CAACa,IAAF,GAASrB,0BAA0B,CAACG,WAAD,CAAnC,GAAmDsB,4BAA4B,CAACtB,WAAD,EAAcc,MAAM,CAACS,aAArB,CAA/E;AACH;AACJ,GAlBA;AAmBJ,CAvBD","sourcesContent":["import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'\nimport { postNoProxyConfirmedToTrackingSheet } from './postNoProxyConfirmedOnSheet'\n\nexport const findMissingFiles = (missingFile) => {\n    // debugger\n    // const GSHEETS_SHEET_ID = process.env.REACT_APP_QA_SS_PHASEII_SHEET_ID\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN \n    let fileName =  `/*/_${missingFile.video.mcVodId}_HD.wmv` \n    debugger\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            debugger\n            if(rxData.error){\n                alert(rxData.error.message)\n            }else{\n                let file = rxData.files.find(file => file.name === fileName)\n                debugger\n                !!file ? postNoProxyToTrackingSheet(missingFile) : searchNextPageForMissingFile(missingFile, rxData.nextPageToken) \n            }\n        })\n}\n\nconst searchNextPageForMissingFile = (missingFile, nextPageToken) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    let fileName =  `/*/_${missingFile.video.mcVodId}_HD.wmv` \n\n     fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n        headers:{\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(reponse => reponse.json())\n    .then(rxData => {\n        debugger\n        if(rxData.error){\n            // TO DO: CHANGE THIS TO MARK THE TRACKING SHEET REVIEWER CELL AS RED\n            debugger\n            postNoProxyConfirmedToTrackingSheet(missingFile)\n            // alert(`Still Can Not Find ${fileName}`)\n        }else{\n            debugger\n            let file = rxData.files.find(file => file.name === fileName)\n            // debugger\n            !!file ? postNoProxyToTrackingSheet(missingFile) : searchNextPageForMissingFile(missingFile, rxData.nextPageToken)\n        }\n    })\n}"]},"metadata":{},"sourceType":"module"}