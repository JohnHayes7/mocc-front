{"ast":null,"code":"var _jsxFileName = \"/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/components/qa/Qa_Project_Info.js\";\nimport React, { useState } from 'react';\nimport './qa_project.css';\nimport AssetTicket from '../AssetTicket';\nimport SelectionInfo from \"../SelectionInfo\";\nimport { postReviewerDataToSheet } from '../../actions/postReviewerDataToSheet';\nimport { postAutoAssignmentToTracker } from '../../actions/postAutoAssignmentToTracker';\nimport { connect } from 'react-redux';\nimport { moveFoundFilesToReviewerFolder } from '../../actions/moveFoundFilesToReviewerFolder';\nimport { findMissingFiles } from '../../actions/findMissingFiles';\nimport ProgressPanel from '../ProgressPanel';\n\nconst QaProjectInfo = props => {\n  // console.log(props.details)\n  const availableLanguages = [\"English\", \"Spanish\"];\n  const reviewers = props.details.availableReviewers;\n  const [selectedVideos, setSelected] = useState([]);\n  const [selectedCount, setSelectedCount] = useState(0);\n  const [selectedLanguage, setSelectedLanguage] = useState(\"English\");\n  const [progressPanel, showProgressPanel] = useState(false);\n\n  const addVideoToSelected = vodId => {\n    const videoIdAndRow = {};\n    videoIdAndRow[\"mcVodId\"] = vodId.split(\"-\")[0];\n    videoIdAndRow[\"row\"] = vodId.split(\"-\")[1];\n    setSelectedCount(selectedCount + 1);\n    setSelected([...selectedVideos, videoIdAndRow]);\n    selectedVideos.push(videoIdAndRow); // console.log(selectedVideos)\n  };\n\n  const findIndex = (array, attr, value) => {\n    for (let i = 0; i < array.length; i += 1) {\n      if (array[i][attr] === value) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  const assignmentsCompletedByReviewer = reviewer => props.details.videos.filter(video => video.reviewer === reviewer.name && video.mcQastatus);\n\n  const assignmentsNotCompletedByReviewer = reviewer => props.details.videos.filter(video => video.reviewer === reviewer.name && !video.mcQastatus);\n\n  const totalAssignmentsByReviewer = reviewer => assignmentsCompletedByReviewer(reviewer).length + assignmentsNotCompletedByReviewer(reviewer).length;\n\n  const updateAllReviewers = () => {\n    reviewers.shift();\n    reviewers.forEach(reviewer => {\n      const reviewerData = {\n        name: reviewer.name,\n        rowId: reviewer.rowId,\n        totalAssignments: totalAssignmentsByReviewer(reviewer),\n        assignmentsCompleted: assignmentsCompletedByReviewer(reviewer).length\n      };\n      props.postReviewerDataToSheet(reviewerData);\n    });\n    alert(\"Reviewers Have Been Successfuly Updated\");\n  };\n\n  const removeVideoFromSelected = vodId => {\n    const index = findIndex(selectedVideos, \"mcVodId\", vodId);\n    selectedVideos.splice(index, 1);\n    setSelectedCount(selectedCount - 1); // console.log(selectedVideos) \n  }; // TO DO: MOVE TO UTILITIES\n\n\n  const updateMissingProxies = () => {\n    //  showProgressPanel(true)\n    missingProxies.slice(0, 10).forEach(proxy => {\n      debugger;\n      const video = {\n        mcVodId: proxy.mvVodId,\n        row: proxy.rowID\n      };\n      const missingVideo = {\n        video: video,\n        reviewer: proxy.reviewer\n      };\n      findMissingFiles(missingVideo);\n    });\n  }; // TO DO: MOVE TO UTILITES\n\n\n  const assignFoundProxies = () => {\n    foundProxies.forEach(proxy => {\n      let id = proxy.rowID;\n      const videosAry = props.details.videos;\n      const proxyIndex = findIndex(props.details.videos, \"rowID\", id);\n      const previousReviewer = findPreviousReviewer(videosAry, proxyIndex, 0);\n      const nextReviewer = findNextReviewer(videosAry, proxyIndex, 0);\n      previousReviewer === nextReviewer ? proxy.reviewer = previousReviewer : proxy.reviewer = nextReviewer;\n      postAutoAssignmentToTracker(proxy);\n      moveFoundFilesToReviewerFolder(proxy);\n    });\n  }; // TO DO: MOVE TO UTILITES\n\n\n  const findPreviousReviewer = (videosAry, index, count) => {\n    count += 1;\n    let assigned = videosAry[index - count].reviewer === \"Proxy Found\" || videosAry[index - count].reviewer === \"No Proxy\" || videosAry[index - count].reviewer === 'Corrupt File' || videosAry[index - count].reviewer === 'Corrupt' || videosAry[index - count].reviewer === \"\" || videosAry[index - count].reviewer === \"No Proxy Confirmed\" ? false : true;\n    return !assigned ? findPreviousReviewer(videosAry, index, count) : videosAry[index - count].reviewer;\n  }; // TO DO: MOVE TO UTILITES AND REFACTOR\n\n\n  const findNextReviewer = (videosAry, index, count) => {\n    count += 1;\n    let assigned = videosAry[index + count].reviewer === \"Proxy Found\" || videosAry[index + count].reviewer === \"No Proxy\" || videosAry[index + count].reviewer === 'Corrupt File' || videosAry[index - count].reviewer === 'Corrupt' || videosAry[index + count].reviewer === \"\" || videosAry[index - count].reviewer === \"No Proxy Confirmed\" ? false : true;\n    return !assigned ? findNextReviewer(videosAry, index, count) : videosAry[index + count].reviewer;\n  };\n\n  const reportIssues = (missingProxies, corruptProxies) => {\n    debugger;\n  };\n\n  const missingProxies = props.details.videos.filter(video => video.reviewer === \"No Proxy\" || video.reviewer === \"No Proxy Confirmed\");\n  const corruptProxies = props.details.videos.filter(video => video.reviewer === \"Corrupt File\");\n  const foundProxies = props.details.videos.filter(video => video.reviewer === 'Proxy Found');\n\n  const parseAssetDetails = () => props.details.videos.map(video => !video.reviewer && video.mvVodId && video.language === selectedLanguage ? /*#__PURE__*/React.createElement(AssetTicket, {\n    key: video.mvVodId,\n    video: video,\n    removeVideoFromSelected: removeVideoFromSelected,\n    addVideoToSelected: addVideoToSelected,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 144\n    }\n  }) : null);\n\n  const parseReviewers = () => reviewers.map(r => /*#__PURE__*/React.createElement(\"option\", {\n    key: r.name,\n    value: r.name,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 53\n    }\n  }, r.name));\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"asset-info\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"asset-details-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 17\n    }\n  }, \"Show \", /*#__PURE__*/React.createElement(\"select\", {\n    onChange: event => setSelectedLanguage(event.currentTarget.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 26\n    }\n  }, /*#__PURE__*/React.createElement(\"option\", {\n    key: \"English\",\n    value: \"English\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 28\n    }\n  }, \"English\"), /*#__PURE__*/React.createElement(\"option\", {\n    key: \"Spanish\",\n    value: \"Spanish\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 28\n    }\n  }, \"Spanish\")), \"Language Assets\"), parseAssetDetails()), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"selection-column\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: updateAllReviewers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, \"Update All Reviewers\"), missingProxies.length > 0 ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: updateMissingProxies,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 46\n    }\n  }, \"Update Missing Proxies\") : null, foundProxies.length > 0 ? /*#__PURE__*/React.createElement(\"button\", {\n    onClick: assignFoundProxies,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 44\n    }\n  }, \"Assign Found Proxies\") : null, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: reportIssues,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 17\n    }\n  }, \"Report Issues\"), selectedCount > 0 ? /*#__PURE__*/React.createElement(SelectionInfo, {\n    allVideos: props.details.videos,\n    parseReviewers: parseReviewers,\n    count: selectedCount,\n    selectedVideos: selectedVideos,\n    reviewers: reviewers,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 38\n    }\n  }) : /*#__PURE__*/React.createElement(\"h4\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 199\n    }\n  }, \"Select Videos for Details\"), progressPanel ? /*#__PURE__*/React.createElement(ProgressPanel, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 34\n    }\n  }) : null));\n};\n\nconst mapDispatchToProps = dispatch => ({\n  postReviewerDataToSheet: reviewerData => dispatch(postReviewerDataToSheet(reviewerData))\n});\n\nexport default connect(0, mapDispatchToProps)(QaProjectInfo);","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/components/qa/Qa_Project_Info.js"],"names":["React","useState","AssetTicket","SelectionInfo","postReviewerDataToSheet","postAutoAssignmentToTracker","connect","moveFoundFilesToReviewerFolder","findMissingFiles","ProgressPanel","QaProjectInfo","props","availableLanguages","reviewers","details","availableReviewers","selectedVideos","setSelected","selectedCount","setSelectedCount","selectedLanguage","setSelectedLanguage","progressPanel","showProgressPanel","addVideoToSelected","vodId","videoIdAndRow","split","push","findIndex","array","attr","value","i","length","assignmentsCompletedByReviewer","reviewer","videos","filter","video","name","mcQastatus","assignmentsNotCompletedByReviewer","totalAssignmentsByReviewer","updateAllReviewers","shift","forEach","reviewerData","rowId","totalAssignments","assignmentsCompleted","alert","removeVideoFromSelected","index","splice","updateMissingProxies","missingProxies","slice","proxy","mcVodId","mvVodId","row","rowID","missingVideo","assignFoundProxies","foundProxies","id","videosAry","proxyIndex","previousReviewer","findPreviousReviewer","nextReviewer","findNextReviewer","count","assigned","reportIssues","corruptProxies","parseAssetDetails","map","language","parseReviewers","r","event","currentTarget","mapDispatchToProps","dispatch"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport './qa_project.css'\nimport AssetTicket from '../AssetTicket'\nimport SelectionInfo from \"../SelectionInfo\"\nimport { postReviewerDataToSheet } from '../../actions/postReviewerDataToSheet'\nimport { postAutoAssignmentToTracker } from '../../actions/postAutoAssignmentToTracker'\nimport { connect } from 'react-redux'\nimport { moveFoundFilesToReviewerFolder } from '../../actions/moveFoundFilesToReviewerFolder'\nimport { findMissingFiles } from '../../actions/findMissingFiles'\nimport ProgressPanel from '../ProgressPanel'\n\nconst QaProjectInfo = props =>{\n    // console.log(props.details)\n    const availableLanguages = [\"English\", \"Spanish\"]\n    const reviewers = props.details.availableReviewers\n    const [selectedVideos, setSelected] = useState([])\n    const [selectedCount, setSelectedCount] = useState(0)\n    const [selectedLanguage, setSelectedLanguage] = useState(\"English\")\n    const [progressPanel, showProgressPanel] = useState(false)\n    \n    const addVideoToSelected = (vodId) =>{\n        const videoIdAndRow = {}\n        videoIdAndRow[\"mcVodId\"] = vodId.split(\"-\")[0]\n        videoIdAndRow[\"row\"] = vodId.split(\"-\")[1]\n        setSelectedCount(selectedCount + 1)\n        setSelected([...selectedVideos, videoIdAndRow])\n        selectedVideos.push(videoIdAndRow)\n        // console.log(selectedVideos)\n    }\n\n    const findIndex = (array, attr, value) => {\n        for(let i = 0; i < array.length; i += 1){\n            if(array[i][attr] === value){\n                return i\n            }\n        }\n        return -1\n    }\n    const assignmentsCompletedByReviewer = (reviewer) => props.details.videos.filter(video => video.reviewer === reviewer.name && video.mcQastatus)\n    \n    const assignmentsNotCompletedByReviewer = (reviewer) => props.details.videos.filter(video => video.reviewer === reviewer.name && !video.mcQastatus)\n\n    const totalAssignmentsByReviewer = (reviewer) => assignmentsCompletedByReviewer(reviewer).length + assignmentsNotCompletedByReviewer(reviewer).length\n   \n    const updateAllReviewers = () => {\n        reviewers.shift()\n        reviewers.forEach(reviewer => {\n            const reviewerData = {\n                name: reviewer.name,\n                rowId: reviewer.rowId,\n                totalAssignments: totalAssignmentsByReviewer(reviewer),\n                assignmentsCompleted: assignmentsCompletedByReviewer(reviewer).length\n            }\n\n            props.postReviewerDataToSheet(reviewerData)\n        });\n        alert(\"Reviewers Have Been Successfuly Updated\")\n    }\n\n\n    const removeVideoFromSelected = (vodId) => {\n        const index = findIndex(selectedVideos, \"mcVodId\", vodId)\n        selectedVideos.splice(index, 1)\n        setSelectedCount(selectedCount - 1)\n        // console.log(selectedVideos) \n    }\n\n    // TO DO: MOVE TO UTILITIES\n     const updateMissingProxies = () => {\n        //  showProgressPanel(true)\n        missingProxies.slice(0, 10).forEach(proxy => {\n            debugger\n            const video = {\n                mcVodId: proxy.mvVodId,\n                row: proxy.rowID\n            }\n             const missingVideo = {\n                 video: video,\n                 reviewer: proxy.reviewer\n            }\n\n             findMissingFiles(missingVideo)\n        })\n    }\n\n    // TO DO: MOVE TO UTILITES\n    const assignFoundProxies = () => {\n        foundProxies.forEach(proxy => {\n            let id = proxy.rowID\n            const videosAry = props.details.videos\n            const proxyIndex = findIndex(props.details.videos, \"rowID\", id)\n            const previousReviewer = findPreviousReviewer(videosAry, proxyIndex, 0)\n            const nextReviewer = findNextReviewer(videosAry,proxyIndex, 0)\n            previousReviewer === nextReviewer ? proxy.reviewer = previousReviewer : proxy.reviewer = nextReviewer\n            postAutoAssignmentToTracker(proxy)\n            moveFoundFilesToReviewerFolder(proxy) \n        })\n    }\n\n    // TO DO: MOVE TO UTILITES\n    const findPreviousReviewer = (videosAry, index, count) => {\n        count += 1\n        let assigned = videosAry[index - count].reviewer === \"Proxy Found\" || videosAry[index-count].reviewer === \"No Proxy\" || videosAry[index-count].reviewer === 'Corrupt File' || videosAry[index-count].reviewer === 'Corrupt' || videosAry[index-count].reviewer === \"\" || videosAry[index-count].reviewer === \"No Proxy Confirmed\" ? false : true\n        return !assigned ? findPreviousReviewer(videosAry,index,count) : videosAry[index - count].reviewer\n    }\n\n    // TO DO: MOVE TO UTILITES AND REFACTOR\n    const findNextReviewer = (videosAry, index, count) => {\n        count += 1\n        let assigned = videosAry[index + count].reviewer === \"Proxy Found\" || videosAry[index + count].reviewer === \"No Proxy\" || videosAry[index + count].reviewer === 'Corrupt File' || videosAry[index-count].reviewer === 'Corrupt' || videosAry[index + count].reviewer === \"\" || videosAry[index-count].reviewer === \"No Proxy Confirmed\" ? false : true\n        return !assigned ? findNextReviewer(videosAry, index, count) : videosAry[index + count].reviewer\n    }\n\n    const reportIssues = (missingProxies, corruptProxies) => {\n        debugger\n    }\n    \n   \n    const missingProxies = props.details.videos.filter(video => video.reviewer === \"No Proxy\" || video.reviewer === \"No Proxy Confirmed\")\n    const corruptProxies = props.details.videos.filter(video => video.reviewer === \"Corrupt File\")\n    const foundProxies = props.details.videos.filter(video => video.reviewer === 'Proxy Found')\n    const parseAssetDetails = () => props.details.videos.map(video => !video.reviewer && video.mvVodId && video.language === selectedLanguage? <AssetTicket key={video.mvVodId} video={video} removeVideoFromSelected={removeVideoFromSelected} addVideoToSelected={addVideoToSelected} /> : null)\n    const parseReviewers = () => reviewers.map(r => <option key={r.name} value={r.name}>{r.name}</option>)\n    \n    return(\n        <div id=\"asset-info\">\n            <div className=\"asset-details-column\">\n                <div>\n                    Show <select onChange={event => setSelectedLanguage(event.currentTarget.value)}>\n                           \n                           <option key=\"English\" value=\"English\">English</option>\n                           <option key=\"Spanish\" value=\"Spanish\">Spanish</option>\n                        </select>\n                    Language Assets\n                </div>\n                {parseAssetDetails()}\n            </div>\n            <div className=\"selection-column\">\n                <button onClick = {updateAllReviewers}>Update All Reviewers</button>\n                {missingProxies.length > 0 ? <button onClick = {updateMissingProxies}>Update Missing Proxies</button> : null}\n                {foundProxies.length > 0 ? <button onClick = {assignFoundProxies}>Assign Found Proxies</button> : null}\n                <button onClick = {reportIssues}>Report Issues</button>\n                {selectedCount > 0 ? <SelectionInfo allVideos={props.details.videos} parseReviewers={parseReviewers} count={selectedCount} selectedVideos={selectedVideos} reviewers={reviewers}/>  : <h4>Select Videos for Details</h4>}\n                {progressPanel ? <ProgressPanel /> : null}\n            </div>\n        </div>\n    )\n}\n\nconst mapDispatchToProps = dispatch =>({\n    postReviewerDataToSheet: reviewerData => dispatch(postReviewerDataToSheet(reviewerData))\n})\n\nexport default connect (0, mapDispatchToProps)(QaProjectInfo)"]},"metadata":{},"sourceType":"module"}