{"ast":null,"code":"import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'; // THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\n\nexport const findDriveFolderIds = selectionData => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `KS_${selectionData.video.mcVodId}_HD.wmv`;\n  let folderName = `${selectionData.reviewer}_QA`; // TO DO: MAKE THIS DYNAMIC\n\n  const reviewerIds = {\n    \"Craig_QA\": \"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n    \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n    \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n    \"Mike_Berlin_QA\": \"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n    \"Ron_QA\": \"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n    \"Shane_QA\": \"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n    \"Tim_QA\": \"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\",\n    \"Josh_QA\": \"10C8Fod-PfX7wBr1R1PjRoncSIZTV8syq\",\n    \"Luke_Simi_QA\": \"1nzSF18X0eBUAfE-_GC2SzkyliGsPSxEK\"\n  };\n  debugger;\n  return dispatch => {\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, {\n      headers: {\n        authorization: `Bearer ${ACCESS_TOKEN}`\n      }\n    }).then(response => response.json()).then(rxData => {\n      debugger;\n      const reviewerFolder = reviewerIds[folderName] || null;\n      const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\";\n      debugger; // GET FILE IDS OF SELECTED VIDEOS\n\n      if (rxData.error) {\n        postNoProxyToTrackingSheet(selectionData);\n      } else if (rxData.files.find(file => file.name === fileName)) {\n        const fileId = rxData.files.find(file => file.name === fileName).id;\n        const dataForUpdate = {\n          fileId: fileId,\n          fileName: fileName,\n          reviewerName: selectionData.reviewer,\n          reviewerFolderId: reviewerFolder,\n          parentFolderId: oldParentFolder\n        };\n        debugger;\n        updateDriveFolders(dataForUpdate);\n      } else {\n        checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder);\n      }\n    });\n  };\n};\nexport const updateDriveFolders = dataForUpdate => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`;\n  fetch(url, {\n    method: 'PATCH',\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    rxData.error ? alert(rxData.error) : alert(`You have moved ${dataForUpdate.fileName}`);\n  });\n};\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const name = `KS_${missingProxy.video.mcVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(reponse => reponse.json()).then(rxData => {\n    debugger;\n\n    if (rxData.error) {\n      postNoProxyToTrackingSheet(missingProxy);\n    } else if (rxData.files.find(file => file.name === name)) {\n      const selectedFileDriveId = rxData.files.find(file => file.name === name).id;\n      const dataForUpdate = {\n        fileId: selectedFileDriveId,\n        fileName: name,\n        reviewerFolderId: reviewerFolder,\n        parentFolderId: oldParentFolder\n      };\n      updateDriveFolders(dataForUpdate);\n    } else {\n      checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/moveToSelectedDriveFolder.js"],"names":["postNoProxyToTrackingSheet","findDriveFolderIds","selectionData","ACCESS_TOKEN","process","env","REACT_APP_ACCESS_TOKEN","fileName","video","mcVodId","folderName","reviewer","reviewerIds","dispatch","fetch","headers","authorization","then","response","json","rxData","reviewerFolder","oldParentFolder","error","files","find","file","name","fileId","id","dataForUpdate","reviewerName","reviewerFolderId","parentFolderId","updateDriveFolders","checkNextPageForVideo","nextPageToken","url","method","alert","missingProxy","reponse","selectedFileDriveId"],"mappings":"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","sourcesContent":["import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'\n// THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\nexport const findDriveFolderIds = (selectionData) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n   \n    let fileName =  `KS_${selectionData.video.mcVodId}_HD.wmv` \n    let folderName = `${selectionData.reviewer}_QA` \n    \n    // TO DO: MAKE THIS DYNAMIC\n    const reviewerIds = {\n        \"Craig_QA\":\"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n        \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n        \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n        \"Mike_Berlin_QA\":\"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n        \"Ron_QA\":\"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n        \"Shane_QA\":\"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n        \"Tim_QA\":\"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\",\n        \"Josh_QA\": \"10C8Fod-PfX7wBr1R1PjRoncSIZTV8syq\",\n        \"Luke_Simi_QA\" : \"1nzSF18X0eBUAfE-_GC2SzkyliGsPSxEK\"\n    }\n   debugger\n    return (dispatch) => {\n        fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            debugger\n            const reviewerFolder = reviewerIds[folderName] || null\n            const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\"\n            debugger\n            // GET FILE IDS OF SELECTED VIDEOS\n            if(rxData.error){\n                postNoProxyToTrackingSheet(selectionData)    \n            }else if(rxData.files.find(file => file.name === fileName)){\n                const fileId = rxData.files.find(file => file.name === fileName).id  \n                    const dataForUpdate = {\n                        fileId: fileId,\n                        fileName: fileName,\n                        reviewerName: selectionData.reviewer,\n                        reviewerFolderId: reviewerFolder,\n                        parentFolderId: oldParentFolder\n                    }\n                    debugger\n                    updateDriveFolders(dataForUpdate) \n                \n            }else{\n                checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder)\n            } \n        })\n    }\n}\n\n\nexport const updateDriveFolders = (dataForUpdate) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`\n    fetch(url, {\n        method: 'PATCH',\n        headers: {\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(response => response.json())\n    .then(rxData => {\n        rxData.error ? alert(rxData.error) :alert(`You have moved ${dataForUpdate.fileName}`)\n    })  \n}\n\n\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    \n   \n    const name = `KS_${missingProxy.video.mcVodId}_HD.wmv`\n\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n        headers:{\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(reponse => reponse.json())\n    .then(rxData => {\n        debugger\n        if(rxData.error){\n            postNoProxyToTrackingSheet(missingProxy)\n        }else if(rxData.files.find(file => file.name === name)){\n            const selectedFileDriveId = rxData.files.find(file => file.name === name).id\n            const dataForUpdate = {\n                fileId: selectedFileDriveId,\n                fileName: name,\n                reviewerFolderId: reviewerFolder,\n                parentFolderId: oldParentFolder\n            }\n            updateDriveFolders(dataForUpdate)\n             \n        }else{\n            checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder)\n        }\n    })\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}