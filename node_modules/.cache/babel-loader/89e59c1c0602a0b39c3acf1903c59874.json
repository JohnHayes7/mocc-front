{"ast":null,"code":"import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet';\nexport const findDriveFolderIds = selectionData => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let vodId = selectionData.video.mcVodId;\n  let fileName = `/*/_${vodId}_HD.wmv`;\n  let folderName = `${selectionData.reviewer}_QA`; // TO DO: MAKE THIS DYNAMIC\n\n  const reviewerIds = {\n    \"Craig_QA\": \"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n    \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n    \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n    \"Mike_Berlin_QA\": \"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n    \"Ron_QA\": \"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n    \"Shane_QA\": \"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n    \"Tim_QA\": \"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\",\n    \"Josh_QA\": \"10C8Fod-PfX7wBr1R1PjRoncSIZTV8syq\",\n    \"Luke_Simi_QA\": \"1nzSF18X0eBUAfE-_GC2SzkyliGsPSxEK\",\n    \"Steve_QA\": \"1Yxd4w1tcqqREWVPA2hE87GWCvc8ameYb\",\n    \"Ebis_QA\": \"1i3en-0yFcbjF0IVemaSg5w70VMtBlcw7\",\n    \"Devin_QA\": \"11vJedJQTl_PBBbXaVxET_lfQv2yGVGdS\"\n  };\n  return dispatch => {\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, {\n      headers: {\n        authorization: `Bearer ${ACCESS_TOKEN}`\n      }\n    }).then(response => response.json()).then(rxData => {\n      const reviewerFolder = reviewerIds[folderName] || null;\n      const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\";\n\n      if (rxData.error) {\n        postNoProxyToTrackingSheet(selectionData);\n      } else if (rxData.files.find(file => file.name === fileName)) {\n        const fileId = rxData.files.find(file => file.name === fileName).id;\n        const dataForUpdate = {\n          fileId: fileId,\n          fileName: fileName,\n          reviewerName: selectionData.reviewer,\n          reviewerFolderId: reviewerFolder,\n          parentFolderId: oldParentFolder\n        };\n        updateDriveFolders(dataForUpdate);\n      } else {\n        checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder);\n      }\n    });\n  };\n};\nexport const updateDriveFolders = dataForUpdate => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`;\n  fetch(url, {\n    method: 'PATCH',\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    rxData.error ? alert(rxData.error.message) : alert(`You have moved ${dataForUpdate.fileName}`);\n  });\n};\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const name = missingProxy.video ? `KS_${missingProxy.video.mcVodId}_HD.wmv` : `KS_${missingProxy.mvVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(reponse => reponse.json()).then(rxData => {\n    debugger;\n\n    if (rxData.error) {\n      postNoProxyToTrackingSheet(missingProxy);\n    } else if (rxData.files.find(file => file.name === name)) {\n      const selectedFileDriveId = rxData.files.find(file => file.name === name).id;\n      const dataForUpdate = {\n        fileId: selectedFileDriveId,\n        fileName: name,\n        reviewerFolderId: reviewerFolder,\n        parentFolderId: oldParentFolder\n      };\n      updateDriveFolders(dataForUpdate);\n    } else {\n      checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/moveToSelectedDriveFolder.js"],"names":["postNoProxyToTrackingSheet","findDriveFolderIds","selectionData","ACCESS_TOKEN","process","env","REACT_APP_ACCESS_TOKEN","vodId","video","mcVodId","fileName","folderName","reviewer","reviewerIds","dispatch","fetch","headers","authorization","then","response","json","rxData","reviewerFolder","oldParentFolder","error","files","find","file","name","fileId","id","dataForUpdate","reviewerName","reviewerFolderId","parentFolderId","updateDriveFolders","checkNextPageForVideo","nextPageToken","url","method","alert","message","missingProxy","mvVodId","reponse","selectedFileDriveId"],"mappings":"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","sourcesContent":["import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'\nexport const findDriveFolderIds = (selectionData) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    let vodId = selectionData.video.mcVodId    \n    let fileName =  `/*/_${vodId}_HD.wmv` \n    let folderName = `${selectionData.reviewer}_QA` \n    \n    // TO DO: MAKE THIS DYNAMIC\n    const reviewerIds = {\n        \"Craig_QA\":\"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n        \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n        \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n        \"Mike_Berlin_QA\":\"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n        \"Ron_QA\":\"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n        \"Shane_QA\":\"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n        \"Tim_QA\":\"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\",\n        \"Josh_QA\": \"10C8Fod-PfX7wBr1R1PjRoncSIZTV8syq\",\n        \"Luke_Simi_QA\" : \"1nzSF18X0eBUAfE-_GC2SzkyliGsPSxEK\",\n        \"Steve_QA\" : \"1Yxd4w1tcqqREWVPA2hE87GWCvc8ameYb\",\n        \"Ebis_QA\": \"1i3en-0yFcbjF0IVemaSg5w70VMtBlcw7\",\n        \"Devin_QA\": \"11vJedJQTl_PBBbXaVxET_lfQv2yGVGdS\"\n    }\n    return (dispatch) => {\n        fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            \n            const reviewerFolder = reviewerIds[folderName] || null\n            const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\"\n            \n            if(rxData.error){\n                \n                postNoProxyToTrackingSheet(selectionData)    \n            }else if(rxData.files.find(file => file.name === fileName)){\n                const fileId = rxData.files.find(file => file.name === fileName).id  \n                    const dataForUpdate = {\n                        fileId: fileId,\n                        fileName: fileName,\n                        reviewerName: selectionData.reviewer,\n                        reviewerFolderId: reviewerFolder,\n                        parentFolderId: oldParentFolder\n                    }\n                    \n                    updateDriveFolders(dataForUpdate) \n                \n            }else{\n                checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder)\n            } \n        })\n    }\n}\n\n\nexport const updateDriveFolders = (dataForUpdate) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`\n    fetch(url, {\n        method: 'PATCH',\n        headers: {\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(response => response.json())\n    .then(rxData => {\n        rxData.error ? alert(rxData.error.message) :alert(`You have moved ${dataForUpdate.fileName}`)\n    })  \n}\n\n\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    \n    const name = missingProxy.video ? `KS_${missingProxy.video.mcVodId}_HD.wmv` : `KS_${missingProxy.mvVodId}_HD.wmv`\n\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n        headers:{\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(reponse => reponse.json())\n    .then(rxData => {\n        debugger\n        if(rxData.error){\n            postNoProxyToTrackingSheet(missingProxy)\n        }else if(rxData.files.find(file => file.name === name)){\n            const selectedFileDriveId = rxData.files.find(file => file.name === name).id\n            const dataForUpdate = {\n                fileId: selectedFileDriveId,\n                fileName: name,\n                reviewerFolderId: reviewerFolder,\n                parentFolderId: oldParentFolder\n            }\n            updateDriveFolders(dataForUpdate)\n             \n        }else{\n            checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder)\n        }\n    })\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}