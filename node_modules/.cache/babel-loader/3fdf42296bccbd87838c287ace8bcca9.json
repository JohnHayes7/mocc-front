{"ast":null,"code":"import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet';\nexport const updateMissingFilesOnTrackingSheet = missingFile => {\n  // debugger\n  const GSHEETS_SHEET_ID = process.env.REACT_APP_QA_SS_PHASEII_SHEET_ID;\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `KS_${missingFile.video.mcVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    debugger;\n    let file = rxData.files.find(file => file.name === fileName);\n\n    if (!!file) {\n      postNoProxyToTrackingSheet(file);\n    } else {\n      searchNextPageForMissingFile(missingFile, rxData.nextPageToken);\n    }\n  });\n};\n\nconst searchNextPageForMissingFile = (missingFile, nextPageToken) => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `KS_${missingFile.video.mcVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(reponse => reponse.json()).then(rxData => {\n    debugger;\n    let file = rxData.files.find(file => file.name === fileName); //  debugger\n    //  TO DO: IS THIS AN INFINITE LOOP?\n\n    if (rxData.error) {\n      // TO DO: CHANGE THIS TO MARK THE TRACKING SHEET REVIEWER CELL AS RED\n      debugger;\n      alert(`Still Can Not Find ${fileName}`);\n    } else if (!!file) {\n      debugger;\n      postNoProxyToTrackingSheet(missingFile);\n    } else {\n      searchNextPageForMissingFile(missingFile, rxData.nextPageToken);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/updateMissingFilesOnTrackingSheet.js"],"names":["postNoProxyToTrackingSheet","updateMissingFilesOnTrackingSheet","missingFile","GSHEETS_SHEET_ID","process","env","REACT_APP_QA_SS_PHASEII_SHEET_ID","ACCESS_TOKEN","REACT_APP_ACCESS_TOKEN","fileName","video","mcVodId","fetch","headers","authorization","then","response","json","rxData","file","files","find","name","searchNextPageForMissingFile","nextPageToken","reponse","error","alert"],"mappings":"AAAA,SAASA,0BAAT,QAA2C,2BAA3C;AAEA,OAAO,MAAMC,iCAAiC,GAAIC,WAAD,IAAiB;AAC9D;AACA,QAAMC,gBAAgB,GAAGC,OAAO,CAACC,GAAR,CAAYC,gCAArC;AACA,QAAMC,YAAY,GAAGH,OAAO,CAACC,GAAR,CAAYG,sBAAjC;AACA,MAAIC,QAAQ,GAAK,MAAKP,WAAW,CAACQ,KAAZ,CAAkBC,OAAQ,SAAhD;AAEAC,EAAAA,KAAK,CAAE,6HAAF,EACD;AACIC,IAAAA,OAAO,EAAE;AACLC,MAAAA,aAAa,EAAG,UAASP,YAAa;AADjC;AADb,GADC,CAAL,CAKOQ,IALP,CAKYC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,EALxB,EAMKF,IANL,CAMUG,MAAM,IAAI;AACZ;AACA,QAAIC,IAAI,GAAGD,MAAM,CAACE,KAAP,CAAaC,IAAb,CAAkBF,IAAI,IAAIA,IAAI,CAACG,IAAL,KAAcb,QAAxC,CAAX;;AACA,QAAG,CAAC,CAACU,IAAL,EAAU;AACNnB,MAAAA,0BAA0B,CAACmB,IAAD,CAA1B;AACH,KAFD,MAEK;AACDI,MAAAA,4BAA4B,CAACrB,WAAD,EAAcgB,MAAM,CAACM,aAArB,CAA5B;AACH;AACJ,GAdL;AAeH,CArBM;;AAuBP,MAAMD,4BAA4B,GAAG,CAACrB,WAAD,EAAcsB,aAAd,KAAgC;AACjE,QAAMjB,YAAY,GAAGH,OAAO,CAACC,GAAR,CAAYG,sBAAjC;AACA,MAAIC,QAAQ,GAAK,MAAKP,WAAW,CAACQ,KAAZ,CAAkBC,OAAQ,SAAhD;AAECC,EAAAA,KAAK,CAAE,kHAAiHY,aAAc,yBAAjI,EAA2J;AAC7JX,IAAAA,OAAO,EAAC;AACJC,MAAAA,aAAa,EAAG,UAASP,YAAa;AADlC;AADqJ,GAA3J,CAAL,CAIEQ,IAJF,CAIOU,OAAO,IAAIA,OAAO,CAACR,IAAR,EAJlB,EAKAF,IALA,CAKKG,MAAM,IAAI;AACZ;AACC,QAAIC,IAAI,GAAGD,MAAM,CAACE,KAAP,CAAaC,IAAb,CAAkBF,IAAI,IAAIA,IAAI,CAACG,IAAL,KAAcb,QAAxC,CAAX,CAFW,CAGZ;AACA;;AACC,QAAGS,MAAM,CAACQ,KAAV,EAAgB;AACb;AACC;AACDC,MAAAA,KAAK,CAAE,sBAAqBlB,QAAS,EAAhC,CAAL;AACF,KAJD,MAIM,IAAI,CAAC,CAACU,IAAN,EAAW;AACb;AACDnB,MAAAA,0BAA0B,CAACE,WAAD,CAA1B;AACF,KAHK,MAGD;AACFqB,MAAAA,4BAA4B,CAACrB,WAAD,EAAcgB,MAAM,CAACM,aAArB,CAA5B;AACF;AACL,GApBA;AAqBJ,CAzBD","sourcesContent":["import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'\n\nexport const updateMissingFilesOnTrackingSheet = (missingFile) => {\n    // debugger\n    const GSHEETS_SHEET_ID = process.env.REACT_APP_QA_SS_PHASEII_SHEET_ID\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN \n    let fileName =  `KS_${missingFile.video.mcVodId}_HD.wmv` \n\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            debugger\n            let file = rxData.files.find(file => file.name === fileName)\n            if(!!file){\n                postNoProxyToTrackingSheet(file)\n            }else{\n                searchNextPageForMissingFile(missingFile, rxData.nextPageToken)  \n            }\n        })\n}\n\nconst searchNextPageForMissingFile = (missingFile, nextPageToken) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    let fileName =  `KS_${missingFile.video.mcVodId}_HD.wmv` \n\n     fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n        headers:{\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(reponse => reponse.json())\n    .then(rxData => {\n        debugger\n         let file = rxData.files.find(file => file.name === fileName)\n        //  debugger\n        //  TO DO: IS THIS AN INFINITE LOOP?\n         if(rxData.error){\n            // TO DO: CHANGE THIS TO MARK THE TRACKING SHEET REVIEWER CELL AS RED\n             debugger\n            alert(`Still Can Not Find ${fileName}`)\n         }else if (!!file){\n             debugger\n            postNoProxyToTrackingSheet(missingFile)\n         }else{\n            searchNextPageForMissingFile(missingFile, rxData.nextPageToken)\n         }  \n    })\n}"]},"metadata":{},"sourceType":"module"}