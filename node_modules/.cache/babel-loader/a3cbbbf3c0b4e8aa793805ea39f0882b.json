{"ast":null,"code":"import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'; // THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\n\nexport const findDriveFolderIds = selectionData => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  let fileName = `KS_${selectionData.mvVodId}_HD.wmv` || `KS_${selectionData.video.mvVodId}_HD.wmv`;\n  let folderName = `${selectionData.reviewer}_QA`;\n  debugger; // TO DO: MAKE THIS DYNAMIC\n\n  const reviewerIds = {\n    \"Craig_QA\": \"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n    \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n    \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n    \"Mike_Berlin_QA\": \"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n    \"Ron_QA\": \"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n    \"Shane_QA\": \"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n    \"Tim_QA\": \"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\"\n  };\n  return dispatch => {\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, {\n      headers: {\n        authorization: `Bearer ${ACCESS_TOKEN}`\n      }\n    }).then(response => response.json()).then(rxData => {\n      const reviewerFolder = reviewerIds[folderName];\n      const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\"; // GET FILE IDS OF SELECTED VIDEOS\n\n      if (rxData.files.find(file => file.name === fileName)) {\n        const selectedDriveDataId = rxData.files.find(file => file.name === fileName).id;\n        const dataForUpdate = {\n          fileId: selectedDriveDataId,\n          fileName: fileName,\n          reviewerName: selectionData.reviewer,\n          reviewerFolderId: reviewerFolder,\n          parentFolderId: oldParentFolder\n        };\n        updateDriveFolders(dataForUpdate);\n      } else {\n        checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder);\n      }\n    });\n  };\n};\nexport const updateDriveFolders = dataForUpdate => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`;\n  debugger;\n  fetch(url, {\n    method: 'PATCH',\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    rxData.error ? alert(rxData.error) : alert(`You have moved ${dataForUpdate.fileName}`);\n  });\n};\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const name = `KS_${missingProxy.video.mcVodId}_HD.wmv`;\n  fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(reponse => reponse.json()).then(rxData => {\n    if (rxData.error) {\n      postNoProxyToTrackingSheet(missingProxy);\n    } else if (rxData.files.find(file => file.name === name)) {\n      const selectedFileDriveId = rxData.files.find(file => file.name === name).id;\n      const dataForUpdate = {\n        fileId: selectedFileDriveId,\n        fileName: name,\n        reviewerFolderId: reviewerFolder,\n        parentFolderId: oldParentFolder\n      };\n      updateDriveFolders(dataForUpdate);\n    } else {\n      checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder);\n    }\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/moveToSelectedDriveFolder.js"],"names":["postNoProxyToTrackingSheet","findDriveFolderIds","selectionData","ACCESS_TOKEN","process","env","REACT_APP_ACCESS_TOKEN","fileName","mvVodId","video","folderName","reviewer","reviewerIds","dispatch","fetch","headers","authorization","then","response","json","rxData","reviewerFolder","oldParentFolder","files","find","file","name","selectedDriveDataId","id","dataForUpdate","fileId","reviewerName","reviewerFolderId","parentFolderId","updateDriveFolders","checkNextPageForVideo","nextPageToken","url","method","error","alert","missingProxy","mcVodId","reponse","selectedFileDriveId"],"mappings":"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","sourcesContent":["import { postNoProxyToTrackingSheet } from './postDataToTrackingSheet'\n// THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\nexport const findDriveFolderIds = (selectionData) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n   \n    let fileName = `KS_${selectionData.mvVodId}_HD.wmv` || `KS_${selectionData.video.mvVodId}_HD.wmv` \n    let folderName = `${selectionData.reviewer}_QA` \n    debugger\n    // TO DO: MAKE THIS DYNAMIC\n    const reviewerIds = {\n        \"Craig_QA\":\"1GRkauySLVv3YDsIvv8jM4fLApCI6YKqW\",\n        \"Junior_QA\": \"1TpVBnxkCQwFIPjq-yQreCGm5oc-fR5o2\",\n        \"Mike_G_QA\": \"1BD6vFptjA0N_oAyvQmShSqVMupWXoZxm\",\n        \"Mike_Berlin_QA\":\"1ZLT3gJAxqq7kMGQO-lTEKOvbmfz8UIfe\",\n        \"Ron_QA\":\"1gY0s29gHOt9qUOBmuX6alUGHVaFQDMqb\",\n        \"Shane_QA\":\"14Ot7H6HKw6pks07oLitQkjb25pJFzc0r\",\n        \"Tim_QA\":\"16XBqeXOWpBsw8AV3gbgMMunWKKjMafNH\"\n    }\n   \n    return (dispatch) => {\n        fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            const reviewerFolder = reviewerIds[folderName]\n            const oldParentFolder = \"1shZeeuZyfUucN8egUBkemkmbexmkjWji\"\n            // GET FILE IDS OF SELECTED VIDEOS\n            if(rxData.files.find(file => file.name === fileName)){\n                const selectedDriveDataId = rxData.files.find(file => file.name === fileName).id  \n                    const dataForUpdate = {\n                        fileId: selectedDriveDataId,\n                        fileName: fileName,\n                        reviewerName: selectionData.reviewer,\n                        reviewerFolderId: reviewerFolder,\n                        parentFolderId: oldParentFolder\n                    }\n                    updateDriveFolders(dataForUpdate)         \n            }else{\n                checkNextPageForVideo(rxData.nextPageToken, selectionData, reviewerFolder, oldParentFolder)\n            } \n        })\n    }\n}\n\n\nexport const updateDriveFolders = (dataForUpdate) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolderId}&removeParents=${dataForUpdate.parentFolderId}`\n    debugger\n    fetch(url, {\n        method: 'PATCH',\n        headers: {\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(response => response.json())\n    .then(rxData => {\n        rxData.error ? alert(rxData.error) :alert(`You have moved ${dataForUpdate.fileName}`)\n    })  \n}\n\n\nexport const checkNextPageForVideo = (nextPageToken, missingProxy, reviewerFolder, oldParentFolder) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const name = `KS_${missingProxy.video.mcVodId}_HD.wmv`\n    fetch(`https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&pageToken=${nextPageToken}&supportsAllDrives=true`, {\n        headers:{\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(reponse => reponse.json())\n    .then(rxData => {\n        if(rxData.error){\n            postNoProxyToTrackingSheet(missingProxy)\n        }else if(rxData.files.find(file => file.name === name)){\n            const selectedFileDriveId = rxData.files.find(file => file.name === name).id\n            const dataForUpdate = {\n                fileId: selectedFileDriveId,\n                fileName: name,\n                reviewerFolderId: reviewerFolder,\n                parentFolderId: oldParentFolder\n            }\n            updateDriveFolders(dataForUpdate)\n             \n        }else{\n            checkNextPageForVideo(rxData.nextPageToken, missingProxy, reviewerFolder, oldParentFolder)\n        }\n    })\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}