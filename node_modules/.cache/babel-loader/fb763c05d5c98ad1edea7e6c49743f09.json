{"ast":null,"code":"import { postErrorToTrackingSheet } from './postDataToTrackingSheet'; // THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\n\nexport const findDriveFolderIds = selectionData => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const DRIVE_ID = process.env.REACT_APP_GOOGLEDRIVE_PARENT_ID;\n  const DRIVE_API_KEY = process.env.REACT_APP_GOOGLEDRIVE_API_KEY;\n  const selectedFileNames = [];\n  const selectedNamesAndIds = {};\n  selectionData.selectedVideos.forEach(video => {\n    let name = `KS_${video.mcVodId}_HD.wmv`;\n    selectedFileNames.push(name);\n  }); // `https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`\n\n  return dispatch => {\n    debugger;\n    fetch(`https://www.googleapis.com/drive/v3/files?q:name=KS_224292_HD.wmv`, {\n      headers: {\n        authorization: `Bearer ${ACCESS_TOKEN}`\n      }\n    }).then(response => response.json()).then(rxData => {\n      debugger;\n      console.log(rxData);\n      const reviewerFolder = rxData.files.find(file => file.name === selectionData.reviewer + \"_QA\") ? rxData.files.find(file => file.name === selectionData.reviewer + \"_QA\") : alert(`Can Not Find Folder For ${selectionData.reviewer}`);\n      const oldParentFolder = rxData.files.find(file => file.name === \"TO_BE_ASSIGNED\"); // GET FILE IDS OF SELECTED VIDEOS\n\n      selectedFileNames.forEach(name => {\n        if (rxData.files.find(file => file.name === name)) {\n          const selectedDriveDataId = rxData.files.find(file => file.name === name).id;\n          selectedNamesAndIds[name] = selectedDriveDataId;\n\n          for (let name in selectedNamesAndIds) {\n            let id = selectedNamesAndIds[name];\n            const dataForUpdate = {\n              fileId: id,\n              fileName: name,\n              reviewerName: selectionData.reviewer,\n              reviewerFolder: reviewerFolder,\n              parentFolder: oldParentFolder\n            };\n            updateDriveFolders(dataForUpdate);\n          }\n        } else {\n          // debugger\n          const missingProxy = selectionData.selectedVideos.find(video => `KS_${video.mcVodId}_HD.wmv` === name); // postErrorToTrackingSheet(missingProxy)\n\n          alert(`Cannot Find ${missingProxy.mcVodId}`);\n        }\n      }); // rxData.error ? alert(rxData.error) : alert(\"Updating Folder Data...\")\n      // console.log(\"drive\", rxData)\n    });\n  };\n};\nexport const updateDriveFolders = dataForUpdate => {\n  const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN;\n  const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolder.id}&removeParents=${dataForUpdate.parentFolder.id}`;\n  console.log(url);\n  fetch(url, {\n    method: 'PATCH',\n    headers: {\n      authorization: `Bearer ${ACCESS_TOKEN}`\n    }\n  }).then(response => response.json()).then(rxData => {\n    rxData.error ? alert(rxData.error) : console.log(rxData);\n  });\n};","map":{"version":3,"sources":["/Users/John/Dev/MC/media_ops_control_center/the-mocc-front/src/actions/moveToSelectedDriveFolder.js"],"names":["postErrorToTrackingSheet","findDriveFolderIds","selectionData","ACCESS_TOKEN","process","env","REACT_APP_ACCESS_TOKEN","DRIVE_ID","REACT_APP_GOOGLEDRIVE_PARENT_ID","DRIVE_API_KEY","REACT_APP_GOOGLEDRIVE_API_KEY","selectedFileNames","selectedNamesAndIds","selectedVideos","forEach","video","name","mcVodId","push","dispatch","fetch","headers","authorization","then","response","json","rxData","console","log","reviewerFolder","files","find","file","reviewer","alert","oldParentFolder","selectedDriveDataId","id","dataForUpdate","fileId","fileName","reviewerName","parentFolder","updateDriveFolders","missingProxy","url","method","error"],"mappings":"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","sourcesContent":["import { postErrorToTrackingSheet } from './postDataToTrackingSheet'\n// THIS WHOLE FINDDRIVEFOLDERIDS FUNCTION SHOULD BE REFACTORED TO A FETCH FOLDER DATA FUNCTION\nexport const findDriveFolderIds = (selectionData) =>{\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const DRIVE_ID = process.env.REACT_APP_GOOGLEDRIVE_PARENT_ID\n    const DRIVE_API_KEY = process.env.REACT_APP_GOOGLEDRIVE_API_KEY\n    const selectedFileNames = []\n    const selectedNamesAndIds = {}\n    \n    selectionData.selectedVideos.forEach(video => {\n        let name = `KS_${video.mcVodId}_HD.wmv`\n        selectedFileNames.push(name)\n    })\n\n    // `https://www.googleapis.com/drive/v3/files?corpora=allDrives&includeTeamDriveItems=true&pageSize=1000&supportsAllDrives=true`\n\n    return (dispatch) => {\n        debugger\n        \n        fetch(`https://www.googleapis.com/drive/v3/files?q:name=KS_224292_HD.wmv`, \n        { \n            headers: {\n                authorization: `Bearer ${ACCESS_TOKEN}`\n            }\n        }).then(response => response.json())\n        .then(rxData => {\n            debugger\n            console.log(rxData)\n            const reviewerFolder = rxData.files.find(file => file.name === selectionData.reviewer + \"_QA\") ? rxData.files.find(file => file.name === selectionData.reviewer + \"_QA\") : alert(`Can Not Find Folder For ${selectionData.reviewer}`)\n            const oldParentFolder = rxData.files.find(file => file.name === \"TO_BE_ASSIGNED\")\n            // GET FILE IDS OF SELECTED VIDEOS\n            selectedFileNames.forEach(name => {\n                if(rxData.files.find(file => file.name === name)){\n                    const selectedDriveDataId = rxData.files.find(file => file.name === name).id  \n                    selectedNamesAndIds[name] = selectedDriveDataId\n\n                    for (let name in selectedNamesAndIds){\n                        let id = selectedNamesAndIds[name]\n                        const dataForUpdate = {\n                            fileId: id,\n                            fileName: name,\n                            reviewerName: selectionData.reviewer,\n                            reviewerFolder: reviewerFolder,\n                            parentFolder: oldParentFolder\n                        }\n                        updateDriveFolders(dataForUpdate)\n                    }        \n                }else{\n                    // debugger\n                    const missingProxy = selectionData.selectedVideos.find(video => `KS_${video.mcVodId}_HD.wmv` === name)\n                    // postErrorToTrackingSheet(missingProxy)\n                    alert(`Cannot Find ${missingProxy.mcVodId}`)\n                }\n                \n            })\n\n            \n            // rxData.error ? alert(rxData.error) : alert(\"Updating Folder Data...\")\n            // console.log(\"drive\", rxData)\n            \n        })\n    }\n}\n\nexport const updateDriveFolders = (dataForUpdate) => {\n    const ACCESS_TOKEN = process.env.REACT_APP_ACCESS_TOKEN\n    const url = `https://www.googleapis.com/drive/v3/files/${dataForUpdate.fileId}?addParents=${dataForUpdate.reviewerFolder.id}&removeParents=${dataForUpdate.parentFolder.id}`\n    console.log(url)\n    fetch(url, {\n        method: 'PATCH',\n        headers: {\n            authorization: `Bearer ${ACCESS_TOKEN}`\n        }\n    }).then(response => response.json())\n    .then(rxData => {\n        rxData.error ? alert(rxData.error) : console.log(rxData)\n    })\n}\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}